@use 'mixins' as *;

$font-suzu-sans:
        system-ui,
        -apple-system,
        BlinkMacSystemFont,
        Verdana,
        Segoe UI,
        Roboto,
        Oxygen,
        Ubuntu,
        Cantarell,
        Open Sans,
        Helvetica Neue,
        sans-serif,
        ヒラギノ角ゴ ProN,
        Hiragino Kaku Gothic ProN,
        游ゴシック,
        游ゴシック体,
        YuGothic,
        Yu Gothic,
        メイリオ,
        Meiryo,
        ＭＳ ゴシック,
        MS Gothic,
        HiraKakuProN-W3,
        TakaoExゴシック,
        TakaoExGothic,
        MotoyaLCedar,
        Droid Sans Japanese,
        Noto Sans CJK JP,
        IPAmGothic,
        Apple Color Emoji,
        Segoe UI Emoji,
        Segoe UI Symbol;

$font-suzu-serif:
        Georgia,
        Times New Roman,
        Palatino,
        Baskerville,
        serif,
        ヒラギノ明朝 ProN,
        Hiragino Mincho ProN,
        游明朝,
        游明朝体,
        YuMincho,
        Yu Mincho,
        ＭＳ 明朝,
        MS Mincho,
        HiraMinProN-W3,
        TakaoEx明朝,
        TakaoExMincho,
        MotoyaLCedar,
        Noto Serif CJK JP,
        IPAexMincho,
        Apple Color Emoji,
        Segoe UI Emoji,
        Segoe UI Symbol;

$font-suzu-mono:
        SFMono-Regular,
        Menlo,
        Monaco,
        Consolas,
        Liberation Mono,
        Courier New,
        monospace,
        Apple Color Emoji,
        Segoe UI Emoji,
        Segoe UI Symbol;

:root {
    color-scheme: light dark;
    accent-color: var(--accent);

    --max-page-width: 95%;
    --readable-width: 71rem;

    --base-transition-duration: 150ms;
    --base-transition-function: ease-in-out;

    /* @link https://utopia.fyi/type/calculator?c=320,16,1.2,1240,20,1.25,6,3,&s=0.75|0.5|0.25,1.5|2|3|4|6,s-l&g=s,l,xl,12 */

    --fluid-step--3: clamp(0.5787rem, 0.5574rem + 0.1066vi, 0.64rem);
    --fluid-step--2: clamp(0.6944rem, 0.6577rem + 0.1836vi, 0.8rem);
    --fluid-step--1: clamp(0.8333rem, 0.7754rem + 0.2899vi, 1rem);
    --fluid-step-0: clamp(1rem, 0.913rem + 0.4348vi, 1.25rem);
    --fluid-step-1: clamp(1.2rem, 1.0739rem + 0.6304vi, 1.5625rem);
    --fluid-step-2: clamp(1.44rem, 1.2615rem + 0.8924vi, 1.9531rem);
    --fluid-step-3: clamp(1.728rem, 1.4799rem + 1.2407vi, 2.4414rem);
    --fluid-step-4: clamp(2.0736rem, 1.7334rem + 1.7011vi, 3.0518rem);
    --fluid-step-5: clamp(2.4883rem, 2.027rem + 2.3067vi, 3.8147rem);
    --fluid-step-6: clamp(2.986rem, 2.366rem + 3.0998vi, 4.7684rem);

    /* @link https://utopia.fyi/space/calculator?c=320,16,1.2,1240,20,1.25,6,3,&s=0.75|0.5|0.5,1.5|2|3|4|6,s-l&g=s,l,xl,12 */
    --space-3xs: clamp(0.5rem, 0.4565rem + 0.2174vi, 0.625rem);
    --space-2xs: clamp(0.5rem, 0.4565rem + 0.2174vi, 0.625rem);
    --space-xs: clamp(0.75rem, 0.6848rem + 0.3261vi, 0.9375rem);
    --space-s: clamp(1rem, 0.913rem + 0.4348vi, 1.25rem);
    --space-m: clamp(1.5rem, 1.3696rem + 0.6522vi, 1.875rem);
    --space-l: clamp(2rem, 1.8261rem + 0.8696vi, 2.5rem);
    --space-xl: clamp(3rem, 2.7391rem + 1.3043vi, 3.75rem);
    --space-2xl: clamp(4rem, 3.6522rem + 1.7391vi, 5rem);
    --space-3xl: clamp(6rem, 5.4783rem + 2.6087vi, 7.5rem);

    /* One-up pairs */
    --space-3xs-2xs: clamp(0.5rem, 0.4565rem + 0.2174vi, 0.625rem);
    --space-2xs-xs: clamp(0.5rem, 0.3478rem + 0.7609vi, 0.9375rem);
    --space-xs-s: clamp(0.75rem, 0.5761rem + 0.8696vi, 1.25rem);
    --space-s-m: clamp(1rem, 0.6957rem + 1.5217vi, 1.875rem);
    --space-m-l: clamp(1.5rem, 1.1522rem + 1.7391vi, 2.5rem);
    --space-l-xl: clamp(2rem, 1.3913rem + 3.0435vi, 3.75rem);
    --space-xl-2xl: clamp(3rem, 2.3043rem + 3.4783vi, 5rem);
    --space-2xl-3xl: clamp(4rem, 2.7826rem + 6.087vi, 7.5rem);

    /* Custom pairs */
    --space-s-l: clamp(1rem, 0.4783rem + 2.6087vi, 2.5rem);


    /* @link https://utopia.fyi/grid/calculator?c=320,16,1.2,1240,20,1.25,5,2,&s=0.75|0.5|0.25,1.5|2|3|4|6,s-l&g=s,l,xl,12 */
    --grid-max-width: 77.50rem;
    --gutter: var(--space-s-l, clamp(1rem, 0.4783rem + 2.6087vw, 2.5rem));
    --grid-gutter: var(--gutter);
    --grid-columns: 12;

    --font-size-xs: 0.75rem;
    --font-size-sm: 0.875rem;
    --font-size-md: 1rem;
    --font-size-lg: 1.125rem;
    --font-size-xl: 1.3125rem;
    --font-size-2xl: 1.5rem;
    --font-size-3xl: 2.652rem;
    --font-size-4xl: 4rem;

    --font-suzu-sans: #{$font-suzu-sans};
    --font-suzu-mono: #{$font-suzu-mono};
    --font-suzu-serif: #{$font-suzu-serif};

    --border-size-xs: 1px;
    --border-size-sm: 2px;
    --border-size-md: 4px;
    --border-size-lg: 8px;
    --border-size-xl: 16px;

    --box-offset: var(--border-size-md);
}

*,
*::before,
*::after {
    box-sizing: border-box;
}


html {
    margin: 0 auto;
    height: 100%;
    min-block-size: 100%;
    line-height: 1.5;

    hanging-punctuation: first last;

    -moz-text-size-adjust: none;
    -webkit-text-size-adjust: none;
    text-size-adjust: none;

    scroll-behavior: smooth;
    background: var(--page-bg);
}

body {
    --duration: 1s;
    --timing: ease;

    font-size: var(--fluid-step-0);

    color: var(--text);

    transition:
        color var(--duration) var(--timing),
        background-color var(--duration) var(--timing);

    font-family: var(--font-suzu-sans);

    display: flex;
    flex-direction: column;

    min-block-size: 100%;
    margin: 0;
}

body > header,
body > footer,
body > main {
    inline-size: 100%;
}

h1, .h1,
h2, .h2,
h3, .h3,
h4, .h4,
h5, .h5,
h6, .h6 {
    font-family: var(--font-suzu-sans);
    line-height: 1.1;
    text-wrap: balance;
    font-weight: 600;
    color: var(--heading-color);

    a {
        color: var(--heading-color);
    }
}


h1, .h1 {
    font-size: var(--fluid-step-5);
}

h2, .h2 {
    font-size: var(--fluid-step-4);
}

h3, .h3 {
    font-size: var(--fluid-step-3);
}

h4, .h4 {
    font-size: var(--fluid-step-2);
}

h5, .h5 {
    font-size: var(--fluid-step-1);
}

pre, code {
  font-family: var(--font-suzu-mono);
}


p {
    text-wrap: pretty;
    max-inline-size: 75ch;
}

.u-grid {
    display: grid;
    gap: var(--grid-gutter);
}

.u-flex {
    display: flex;
    gap: var(--grid-gutter);
}

/* Inherit fonts for inputs and buttons */
input, button,
textarea, select {
    font-family: inherit;
    font-size: inherit;
}

/* Make sure textareas without a rows attribute are not tiny */
textarea:not([rows]) {
    min-height: 10em;
}

a#link-to-main {
    --margin: var(--font-size-sm);
    position: absolute;

    z-index: 10;

    top: 0;
    left: var(--margin);
    padding: 4px;
    border: var(--border-size-sm) solid;

    color: var(--text);
    background: var(--page-bg);
    transform: translateY(-100%);
    text-decoration: none;

    transition: transform var(--base-transition-duration) ease;

    &:focus-visible {
        transform: translateY(var(--margin));
    }
}

[role="list"] {
  padding: 0;
  margin-block: 0;
}

ul[role="list"],
ol[role="list"] {
  list-style-type: none;
}

table {
  border-collapse: collapse;

  // TODO(anri): Figure out if we can use table-layout: fixed and make it look
  //             good in general?
}

a {
    color: var(--link);

    &:hover,
    &:focus {
        color: var(--link-hover);
    }

    &:active {
        color: var(--link-active, var(--link-hover));
    }
}

[id] {
    scroll-margin-top: var(--space-m);
}

iframe {
    block-size: 80vh;
}

@import 'themes/base.scss';

@import 'compositions/flow';
@import 'compositions/grid';
@import 'compositions/cluster';
@import 'compositions/repel';
@import 'compositions/sidebar';
@import 'compositions/icon';

@import 'utilities/visually-hidden';
@import 'utilities/wrapper';
@import 'utilities/region';
@import 'utilities/vfill';
@import 'utilities/text';
@import 'utilities/push';
@import 'utilities/full-w';
@import 'utilities/radius';
@import 'utilities/border';
@import 'utilities/popout-box';
@import 'utilities/focus-on-hover';
@import 'utilities/scroll-shadow';
@import 'utilities/pixelart';

@import 'blocks/hr';
@import 'blocks/dropdown';
@import 'blocks/callout';
@import 'blocks/card';
@import 'blocks/carousel';
@import 'blocks/sidenote';
@import 'blocks/pill';
@import 'blocks/metadata-list';
@import 'blocks/site-header';
@import 'blocks/site-language-menu';

@import 'themes/light.scss';
@import 'themes/dark.scss';
